Joins:

_ --INNER JOIN----_
retriving the columns from more than one table
when we need to access the data from different tables we go for joins

Display the book code book name and supplier name of the books in the library

WE HAVE TO JOIN BY USING "ON" CONDITION 
***SELECT BOOK_CODE,BOOK_TITLE,SUPPLIER_NAME FROM LMS_BOOK_DETAILS JOIN LMS_SUPPLIERS_DETAILS ON SUPPLIER_ID = SUPPLIER_ID;

----- WE GET ERROR AS UNAMGIOUS COLUMN --- DUE TO IT CANT KNOW THAT SUPPLIER_ID ARE FROM DIFFERENT TABLES 
TO GET THE ERROR CORRECTED WE HAVE TO SPECIFY THE TABLENAME.SUUOPLIER_ID TO GET TO KNOW WHICH TABLES DATA IS TO BE USED

SELECT BOOK_CODE,BOOK_TITLE,SUPPLIER_NAME FROM LMS_BOOK_DETAILS JOIN LMS_SUPPLIERS_DETAILS ON LMS_BOOK_DETAILS.SUPPLIER_ID = LMS_SUPPLIERS_DETAILS.SUPPLIER_ID;
-------------------------------------------------------
DISPLAY THE BOOK_TITLR AND MEMEBER_ID WHO HAS TAKEN THE BOOKS FROM LIBRARY

SELECT BOOK_TITLE,MEMBER_ID FROM LMS_BOOK_DETAILS JOIN LMS_BOOK_ISSUE ON LMS_BOOK_DETAILS.BOOK_CODE=LMS_BOOK_ISSUE.BOOK_CODE;

IF WE NEED TO GET THE DATA WHICH IS UNIQIE IE:,WE CAN USE DISTINCT KEYWORD

SELECT DISTINCT BOOK_TITLE,MEMBER_ID FROM LMS_BOOK_DETAILS  JOIN LMS_BOOK_ISSUE ON LMS_BOOK_DETAILS.BOOK_CODE=LMS_BOOK_ISSUE.BOOK_CODE; 
SELECT DISTINCT BOOK_TITLE,MEMBER_ID FROM LMS_BOOK_DETAILS  INNER JOIN LMS_BOOK_ISSUE ON LMS_BOOK_DETAILS.BOOK_CODE=LMS_BOOK_ISSUE.BOOK_CODE; 
JOIN KEYWORD IS TAKEN TO CONSIDERATION AS INNER JOIN 
------------------------------------------
****************
N TABLES NEED N-1 JOIN KEYWORDS ARE REQUIRED
-----------------------------------------------
****WE CAN GIVE THE ALIAS NAME BY SPECIFING IT AND WE CAN USE FOR ACCESIN GOF THE TABLES WHEN REQUIRED
SELECT DADA.BOOK_CODE,DADA.BOOK_TITLE,KHALANDAR.SUPPLIER_NAME FROM LMS_BOOK_DETAILS AS DADA JOIN LMS_SUPPLIERS_DETAILS AS KHALANDAR ON DADA.SUPPLIER_ID=KHALANDAR.SUPPLIER_ID;
-----------------------------------------
DISPLAY BOOK_NAME AND MEMBER NAME WHO HAS TAKEN BOOKS
SELECT L1.BOOK_TITLE,L3.MEMNER_NAME FROM LMS_BOOK_DETAILS AS L1 JOIN LMS_BOOK_ISSUE AS L2 ON L1.BOOK_CODE=L2.BOOK_CODE JOIN LMS_MEMBERS AS L3 ON L2.MEMBER_ID = L3.MEMBER_ID;

--------------------------------------------------
WE ARE USING THE 2 JOINS TO RETRIVE THE DATA FROM THE 3 TABLES 
SELECT DISTINCT L1.BOOK_TITLE,L3.MEMBER_NAME FROM LMS_BOOK_DETAILS AS L1 JOIN LMS_BOOK_ISSUE AS L2 ON L1.BOOK_CODE=L2.BOOK_CODE JOIN LMS_MEMBERS AS L3 ON L2.MEMBER_ID = L3.MEMBER_ID;
-----------------------------------------------------------
DISPLAY THE SUPPLIER ID AND NUMBER OF BOOKS SUPPLIED BY EACH SUPPLIER

SELECT SUPPLIER_ID,COUNT(BOOK_CODE) AS NUMBEROFBOOKS FROM LMS_BOOK_DETAILS 
WHERE SUPPLIER_ID IS NOT NULL
GROUP BY SUPPLIER_ID;
-------------------------------------------------------------------
DISPLAY THE SUPPLIERNAME AND NUMBER OF BOOKS SUPPLIED BY EACH SUPPLIER

SELECT SUPPLIER_NAME,COUNT(BOOK_CODE) AS COUNT_OF_BOOKS FROM
 LMS_BOOK_DETAILS AS P1 JOIN LMS_SUPPLIERS_DETAILS AS P2
ON P1.SUPPLIER_ID=P2.SUPPLIER_ID GROUP BY P2.SUPPLIER_NAME,P2.SUPPLIER_ID
-------------------------------------------------------------------------------  17,A1,3,4,5,7,8,10,11,12,13,15
QUESTIONS 

1.

SELECT SUPPLIER_NAME,BOOK_TITLE  FROM 
LMS_BOOK_DETAILS AS P1 JOIN LMS_SUPPLIERS_DETAILS AS P2
ON P1.SUPPLIER_ID = P2.SUPPLIER_ID;

2.

select MEMBER_NAME,BOOK_CODE FROM 
LMS_BOOK_ISSUE AS P1 JOIN LMS_MEMBERS AS P2
ON P1.MEMBER_ID = P2.MEMBER_ID;


3.Write a query to display the book title and date when the book was taken from the library.

SELECT BOOK_TITLE,DATE_ISSUE FROM 
LMS_BOOK_DETAILS AS P1 JOIN LMS_BOOK_ISSUE AS P2
ON P1.BOOK_CODE=P2.BOOK_CODE;
4.Write a query to display the member id and the fine amount paid by the member in the library.

SELECT DISTINCT MEMBER_ID,FINE_AMOUNT FROM
LMS_BOOK_ISSUE AS P1 JOIN  LMS_FINE_DETAILS AS P2
ON P1.FINE_RANGE=P2.FINE_RANGE;

5.Write a query to display the member name and the date difference between the date return and date returned.
SELECT MEMBER_NAME,DATEDIFF(MONTH,'DATE_RETURN','DATE_RETURNED') FROM 
LMS_BOOK_ISSUE AS P1 JOIN LMS_MEMBERS AS P2 
ON P1.MEMBER_ID=P2.MEMBER_ID;

6.Write a query to display the book title and the member name of member who has taken book from library.
SELECT BOOK_TITLE,MEMBER_NAME FROM
LMS_MEMBERS AS P1 JOIN LMS_BOOK_ISSUE AS P2
ON P1.MEMBER_ID=P2.MEMBER_ID
JOIN LMS_BOOK_DETAILS AS P3
ON P2.BOOK_CODE = P3.BOOK_CODE; 


7.Write a query to display the book title, member name and the supplier name for the books taken from the library.
SELECT BOOK_TITLE,MEMBER_NAME,SUPPLIER_NAME FROM
LMS_BOOK_DETAILS AS  P1 JOIN LMS_SUPPLIERS_DETAILS AS P2 
ON P1.SUPPLIER_ID=P2.SUPPLIER_ID
JOIN LMS_BOOK_ISSUE AS P3
ON P1.BOOK_CODE=P3.BOOK_CODE
JOIN LMS_MEMBERS AS P4
ON P3.MEMBER_ID=P4.MEMBER_ID;

------------------------------------------------------------------
17.Write a query to display the member id, member name, 
city and member status of members with the total fine
paid by them with alias name “Fine”.


SELECT P1.MEMBER_ID,MEMBER_NAME,CITY, SUM(P3.FINE_AMOUNT) AS FINE FROM 
LMS_MEMBERS P1 JOIN LMS_BOOK_ISSUE P2 ON
P1.MEMBER_ID = P2.MEMBER_ID JOIN 
LMS_FINE_DETAILS AS P3 ON 
P2.FINE_RANGE = P3.FINE_RANGE
GROUP BY P1.MEMBER_ID, P1.MEMBER_NAME, P1.CITY;
-----------------------------------------------------------------------



